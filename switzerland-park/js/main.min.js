const header=document.querySelector(".header"),menu=document.querySelector(".header__body"),iconMenu=document.querySelector(".icon-menu"),section=document.querySelectorAll("section"),fixedBlocks=document.querySelectorAll(".fixed-block"),modalShowBtn=document.querySelectorAll(".modal-show-btn"),modal=document.querySelectorAll(".modal"),fixedBtn=document.querySelector(".fixed-btn"),headerBtn=document.querySelector(".header__btn"),successModal=document.querySelector(".success-modal"),errorModal=document.querySelector(".error-modal"),filter=document.querySelector(".filter-form"),filterCheckbox=document.querySelector(".filter-form__checkbox"),priceSlider=document.querySelector(".price-slider"),floorSlider=document.querySelector(".floor-slider"),filterReset=document.querySelector(".filter-form__reset"),schemePopup=document.querySelector(".scheme-popup");let paddingValue=window.innerWidth>325?window.innerWidth-document.documentElement.clientWidth+"px":0,modalAnimSpd=500;function windoOnResize(){paddingValue=window.innerWidth>325?window.innerWidth-document.documentElement.clientWidth+"px":0}function enableScroll(){fixedBlocks&&fixedBlocks.forEach((e=>e.style.paddingRight="0px")),document.body.style.paddingRight="0px",document.body.classList.remove("no-scroll")}function disableScroll(){fixedBlocks&&fixedBlocks.forEach((e=>e.style.paddingRight=paddingValue)),document.body.style.paddingRight=paddingValue,document.body.classList.add("no-scroll")}function formSuccess(e){e.querySelectorAll("input").forEach((e=>{"hidden"!=e.type&&(e.value="")})),e.querySelectorAll(".form__item").forEach((e=>e.classList.remove("error"))),e.querySelectorAll(".form__placeholder").forEach((e=>e.style.display="block"));let t=document.querySelector(".modal.open");t&&(t.querySelector(".modal__overlay").classList.remove("open"),t.classList.remove("open")),openModal(successModal)}function filterFormOnReset(e){e.querySelectorAll("input").forEach((e=>{e.checked=!1,priceSlider.noUiSlider.reset(),floorSlider.noUiSlider.reset(),filterReset.classList.remove("show")}))}function openModal(e){fixedBtn.classList.contains("intersect")||window.innerWidth<=767?(fixedBtn.classList.remove("show"),window.innerWidth<=767&&(headerBtn.style.transform="translateY(100%)"),setTimeout((()=>{iconMenu.classList.contains("active")||disableScroll(),e.classList.add("open"),setTimeout((()=>{e.querySelector(".modal__overlay").classList.add("open")}),30)}),300)):(iconMenu.classList.contains("active")||disableScroll(),e.classList.add("open"),setTimeout((()=>{e.querySelector(".modal__overlay").classList.add("open")}),30))}function closeModal(e){e.querySelector(".modal__overlay").classList.remove("open"),setTimeout((()=>{iconMenu.classList.contains("active")||enableScroll(),e.classList.remove("open"),fixedBtn.classList.contains("intersect")&&fixedBtn.classList.add("show"),window.innerWidth<=767&&(headerBtn.style.transform="translateY(0)")}),modalAnimSpd)}window.addEventListener("resize",windoOnResize),window.addEventListener("orientationchange",windoOnResize),modalShowBtn.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();let n=e.getAttribute("data-modal");openModal(document.querySelector(n))}))})),modal.forEach((e=>{e.querySelector(".modal__close").addEventListener("click",(t=>{closeModal(e)})),e.addEventListener("click",(t=>{window.innerWidth>1260&&e.classList.contains("mob-modal")||e.querySelector(".modal__content").contains(t.target)||closeModal(e)}))})),document.querySelectorAll(".mob-modal").forEach((e=>{window.addEventListener("resize",(()=>{e.classList.contains("open")&&window.innerWidth>1260&&closeModal(e)}))})),iconMenu.addEventListener("click",(()=>{iconMenu.classList.contains("active")?(iconMenu.classList.remove("active"),iconMenu.setAttribute("aria-label","Открыть меню"),menu.classList.remove("active"),enableScroll()):(iconMenu.classList.add("active"),iconMenu.setAttribute("aria-label","Закрыть меню"),menu.classList.add("active"),disableScroll())})),section&&section[1]&&window.addEventListener("scroll",(()=>{(window.pageYOffset||document.documentElement.scrollTop)>section[1].getBoundingClientRect().top?window.innerHeight-document.querySelector(".footer__top").getBoundingClientRect().bottom+30>=0?fixedBtn.classList.remove("intersect","show"):fixedBtn.classList.add("intersect","show"):fixedBtn.classList.remove("intersect","show")})),window.addEventListener("scroll",(()=>{window.innerWidth<=767&&window.innerHeight-document.querySelector(".footer__top").getBoundingClientRect().bottom+30>=0?headerBtn.style.transform="translateY(100%)":headerBtn.style.transform="translateY(0%)"}));const inp=document.querySelectorAll("input[type=tel]");if(inp&&inp.forEach((e=>{e.addEventListener("focus",(()=>{e.parentNode.querySelector(".form__placeholder").style.display="none"})),e.addEventListener("blur",(()=>{0===e.value.length&&(e.parentNode.querySelector(".form__placeholder").style.display="block")})),Inputmask({mask:"+7 999 999-99-99"}).mask(e)})),document.querySelector(".features__swiper")){let e,t=!1;function initFeaturesSwiper(){window.innerWidth<=767?t||(t=!0,e=new Swiper(".features__swiper",{slidesPerView:1,slidesPerGroup:1,observer:!0,observeParents:!0,pagination:{el:".features__pagination",type:"bullets",clickable:!0},speed:800})):window.innerWidth>767&&t&&(t=!1,e.destroy())}initFeaturesSwiper(),window.addEventListener("resize",initFeaturesSwiper)}if(document.querySelector(".item-building")){document.querySelectorAll(".item-building").forEach((e=>{let t=e.querySelectorAll(".item-building__images img").length;t>0&&(e.querySelector(".item-building__overlay span").textContent=t+1+" фото")}))}if(document.querySelector(".main-building__swiper")){new Swiper(".main-building__swiper",{slidesPerView:1,slidesPerGroup:1,centeredSlides:!0,spaceBetween:10,observer:!0,observeParents:!0,speed:800,initialSlide:1,breakpoints:{480.98:{slidesPerView:1.3,spaceBetween:20},767.98:{slidesPerView:2,spaceBetween:20},991.98:{slidesPerView:2,spaceBetween:30},1520.98:{slidesPerView:2,spaceBetween:40}},navigation:{nextEl:".main-building-btn--next",prevEl:".main-building-btn--prev"}})}if(document.querySelector(".improvements__swiper")){new Swiper(".improvements__swiper",{slidesPerView:1.14,slidesPerGroup:1,observer:!0,observeParents:!0,speed:800,initialSlide:1,centeredSlides:!0,breakpoints:{480.98:{slidesPerView:1.35},767.98:{slidesPerView:1.65},991.98:{slidesPerView:2.4,centeredSlides:!1},1260.98:{slidesPerView:3,centeredSlides:!1}}})}if(document.querySelector(".flat")){const e=document.querySelector(".flat__btn");let t,n,i,o=!1,r=!1;function flatSwiperInit(){window.innerWidth<=991?(r&&(i.destroy(),t.destroy(),r=!1),o||(n=new Swiper(".flat__mainswiper",{slidesPerView:1,slidesPerGroup:1,observer:!0,observeParents:!0,spaceBetween:5,autoplay:{delay:3500,pauseOnMouseEnter:!0,disableOnInteraction:!1},breakpoints:{767.98:{spaceBetween:20}},speed:800}),o=!0,e.addEventListener("click",(()=>{n.slides[n.activeIndex].click()})))):(o&&(n.destroy(),o=!1),r||(t=new Swiper(".flat__thumbswiper",{slidesPerView:3,slidesPerGroup:1,spaceBetween:20,observer:!0,observeParents:!0,freeMode:!0,speed:800}),i=new Swiper(".flat__mainswiper",{slidesPerView:1,slidesPerGroup:1,observer:!0,observeParents:!0,effect:"fade",thumbs:{swiper:t},speed:300}),r=!0,e.addEventListener("click",(()=>{i.slides[i.activeIndex].click()}))))}flatSwiperInit(),window.addEventListener("resize",flatSwiperInit)}if(document.querySelector(".infra__swiper")){const e=document.querySelector(".infra__swiper");let t=e.querySelectorAll(".swiper-slide").length,n=new Swiper(e,{slidesPerView:1,slidesPerGroup:1,observer:!0,observeParents:!0,pagination:{el:".infra__pagination",type:"bullets",clickable:!0},effect:"fade",speed:700}),i={value:0};gsap.to(i,{value:t-1,scrollTrigger:{trigger:".infra .container",start:"center center",end:"+="+300*t,pin:!0,scrub:!0,invalidateOnRefresh:!0,onUpdate:e=>{n.slideTo(Math.round(i.value))}}})}if(filter){if(filter.querySelectorAll("input").forEach((e=>{e.addEventListener("change",(()=>{filterReset.classList.add("show")}))})),filterCheckbox.querySelectorAll("input").forEach((e=>{e.addEventListener("change",(()=>{filterCheckbox.querySelectorAll("input:checked").length===filterCheckbox.querySelectorAll("input").length&&filterCheckbox.querySelectorAll("input").forEach((e=>e.checked=!1))}))})),priceSlider){noUiSlider.create(priceSlider,{start:[3.34,8.34],connect:!0,range:{min:3.34,max:15}});const e=document.getElementById("price-start"),t=document.getElementById("price-end");e.addEventListener("change",(()=>{priceSlider.noUiSlider.set([e.value,null])})),t.addEventListener("change",(()=>{priceSlider.noUiSlider.set([null,t.value])}));let n=[e,t],i=0;priceSlider.noUiSlider.on("update",(function(e,t){i++,n[t].value=e[t],i>2&&filterReset.classList.add("show")}))}if(floorSlider){noUiSlider.create(floorSlider,{start:[6,10],connect:!0,range:{min:2,max:18}});const e=document.getElementById("floor-start"),t=document.getElementById("floor-end");e.addEventListener("change",(()=>{floorSlider.noUiSlider.set([e.value,null])})),t.addEventListener("change",(()=>{floorSlider.noUiSlider.set([null,t.value])}));let n=[e,t],i=0;floorSlider.noUiSlider.on("update",(function(e,t){i++,n[t].value=parseInt(e[t]),i>2&&filterReset.classList.add("show")}))}document.querySelector(".filter__header").addEventListener("click",(()=>{window.innerWidth<=1260&&openModal(document.querySelector(".mob-modal"))}))}document.querySelector(".catalog-cat__main")&&document.querySelectorAll(".catalog-cat__item").forEach((e=>{const t=e.querySelectorAll(".catalog-cat__img");for(let n=0;n<t.length;n++){let t=document.createElement("span"),n=document.createElement("span");e.querySelector(".catalog-cat__hovers").append(t),e.querySelector(".catalog-cat__controls").append(n)}function n(n,i){let r=e.querySelector(".catalog-cat__hovers").getBoundingClientRect().left,l=n.clientWidth,s=Math.ceil((i-r)/l);s>=1&&s<=t.length?o(s):o(1)}function i(){o(1)}function o(t){e.querySelectorAll(".catalog-cat__img").forEach((e=>e.style.opacity=0)),e.querySelectorAll(".catalog-cat__img")[t-1].style.opacity=1,e.querySelectorAll(".catalog-cat__controls span").forEach((e=>e.style.backgroundColor="transparent")),e.querySelectorAll(".catalog-cat__controls span")[t-1].style.backgroundColor="#006422"}e.querySelectorAll(".catalog-cat__hovers span").forEach(((e,t)=>{e.addEventListener("touchmove",(t=>{n(e,t.touches[0].clientX)})),e.addEventListener("touchend",(()=>i())),e.addEventListener("mousemove",(t=>{n(e,t.clientX)})),e.addEventListener("mouseleave",(()=>i()))}))})),schemePopup&&document.querySelectorAll(".item-apartaments .on-sale").forEach((e=>{e.addEventListener("mousemove",(t=>{window.innerWidth>1260&&(!function(t,n){schemePopup.classList.add("open");let i=e.getBoundingClientRect().top,o=e.getBoundingClientRect().left;window.innerWidth<o+schemePopup.clientWidth+e.clientWidth+50?schemePopup.style.left=t-schemePopup.clientWidth-10+"px":schemePopup.style.left=t+15+"px",window.innerHeight<i+schemePopup.clientHeight+25?schemePopup.style.top=n-schemePopup.clientHeight-5+"px":schemePopup.style.top=n+25+"px"}(t.clientX,t.clientY),e.addEventListener("mouseleave",(()=>{schemePopup.classList.remove("open")})))})),e.addEventListener("click",(e=>{window.innerWidth<=1260&&(e.preventDefault(),openModal(schemePopup))}))}));const catTab=document.querySelectorAll(".catalog__tab"),catBlock=document.querySelectorAll(".catalog__block");if(catTab.forEach(((e,t)=>{e.addEventListener("click",(e=>{e.preventDefault(),catTab.forEach((e=>{e.classList.remove("active")})),catBlock.forEach((e=>{e.classList.remove("active")})),catTab[t].classList.add("active"),catBlock[t].classList.add("active")}))})),document.querySelector(".views")){const e=document.querySelectorAll(".views__btn"),t=document.querySelector(".views__bar");e.forEach((n=>{n.addEventListener("click",(i=>{i.preventDefault(),n.classList.contains("views__btn--night")?(t.style.transform="translateX(100%)",t.style.backgroundColor="#313534",document.querySelector(".views__video--day").style.clipPath="polygon(0 0, 0 0, 0 100%, 0% 100%)"):(t.style.transform="translateX(0%)",t.style.backgroundColor="#ffffff",document.querySelector(".views__video--day").style.clipPath="polygon(0 0, 100% 0, 100% 100%, 0 100%)"),e.forEach((e=>e.classList.remove("active"))),n.classList.add("active")}))}))}if(document.querySelector(".main-choice__img")){let e=document.querySelector(".main-choice__img img");e.addEventListener("mouseenter",(t=>{if(window.innerWidth>1520){e.style.transitionDuration=".5s";const n=t.clientY,i=t.clientX;e.addEventListener("mousemove",(t=>{e.style.transitionDuration="0s";let o=t.clientX-i,r=t.clientY-n;e.style.transform="translate3d("+o/30+"px,"+r/30+"px,0)"})),e.addEventListener("mouseleave",(()=>{e.style.transform="translate3d(0,0,0)",e.style.transitionDuration=".5s"}))}}))}const fancyItems=document.querySelectorAll("[data-fancy]");fancyItems.forEach((e=>{e.addEventListener("click",(()=>{let t=[],n=e.getAttribute("data-fit")?e.getAttribute("data-fit"):"",i=e.getAttribute("data-fancy");fancyItems.forEach((e=>{e.closest(".swiper-slide-duplicate")||e.getAttribute("data-fancy")!==i||t.push(e.getAttribute("data-src"))}));let o=t.indexOf(e.getAttribute("data-src"));document.querySelector("footer").insertAdjacentHTML("afterend",`\n    <div class="modal fancy-modal">\n        <div class="modal__overlay">\n        <button class="modal__close" aria-label="Закрыть всплывающее окно"></button>\n           <div class="modal__content">\n               <div class="swiper fancy-swiper">\n                   <div class="swiper-wrapper">\n                      ${t.map((e=>`<div class="swiper-slide ${n}">\n                            <div class="swiper-img">\n                                <img src=${e} alt="">\n                            </div>\n                        </div>`)).join("")}\n                   </div>\n               </div>\n           </div>\n        </div>\n    </div>\n  `);new Swiper(".fancy-swiper",{slidesPerView:1,slidesPerGroup:1,observer:!0,observeParents:!0,centeredSlides:!0,spaceBetween:5,initialSlide:o,breakpoints:{991.98:{spaceBetween:40},767.98:{spaceBetween:20}}});const r=document.querySelector(".fancy-modal");openModal(r),r.addEventListener("click",(e=>{r.querySelector(".modal__content").contains(e.target)&&!r.querySelector(".modal__close").contains(e.target)||(closeModal(r),setTimeout((()=>{r.remove()}),modalAnimSpd))}))}))})),document.querySelector(".main-map__content")&&gsap.from(".main-map__content",{x:100,duration:1,ease:"power2.out",scrollTrigger:{trigger:".main-map__content",start:"30px bottom",toggleActions:"play none none reverse"}});